name: api-production

on:
    push:
        branches:
            - main

jobs:
    api-production:
        runs-on: ubuntu-latest

        steps:
            - name: Git clone
              run: |
                  git clone https://github.com/Akashpawar11/pingpong1.git
                  cd pingpong1/helm-chart
                  git config --global user.name "wohligakash"
                  git config --global user.email "akash.pawar@wohlig.com"
                  git config --global user.password "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"
                  yq e '.replicaCount = "6"' -i values.yaml
                  git add .
                  git commit -m "updating newer image"
                  git push main main

            - name: Install helm
              run: |
                  curl -LO https://get.helm.sh/helm-v3.8.0-linux-amd64.tar.gz
                  tar -zxvf helm-v3.8.0-linux-amd64.tar.gz
                  mv linux-amd64/helm /usr/local/bin/helm
                  helm version

